<!DOCTYPE html>
<html class="dark" lang="tr">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title data-i18n="app-title">PC ParÃ§a Uyumluluk KontrolÃ¼</title>
    <link rel="icon" type="image/ico" href="Assets/Images/favicon.ico">

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>

<script>
    (function() {
        // TÃ¼m sayfalarda ortak anahtar: 'theme_builder'
        const savedTheme = localStorage.getItem('theme_builder');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    })();
</script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <link rel="stylesheet" href="./styles.css">
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-gray-900 dark:text-gray-200 antialiased transition-default">
<div class="flex flex-col min-h-screen">
    <header class="w-full px-4 md:px-8 py-4 border-b border-gray-200 dark:border-gray-800/50 transition-default">
        <nav class="container mx-auto flex justify-between items-center">
            <a class="flex items-center gap-2 text-xl font-bold text-gray-900 dark:text-white" href="anasayfa.html">
                <img src="Assets/Images/logo.webp" alt="PCPartsBuild Logo" class="h-14 transition-all duration-300 filter dark:filter-none">
            </a>

            <div class="hidden md:flex items-center gap-8 text-sm font-medium text-gray-600 dark:text-gray-300">
                <a class="text-gray-600 dark:text-white/80 text-sm font-medium leading-normal transition-colors hover:text-gray-900 dark:hover:text-white" href="pts.html" data-i18n="nav-wizard">PC Toplama SihirbazÄ±</a>
                <a class="text-primary dark:text-primary text-sm font-medium leading-normal transition-colors" href="puk.html" data-i18n="nav-compatibility">ParÃ§a Uyumluluk KontrolÃ¼</a>
                <a class="text-gray-600 dark:text-white/80 text-sm font-medium leading-normal transition-colors hover:text-gray-900 dark:hover:text-white" href="pbg.html" data-i18n="nav-info">PC BileÅŸenleri</a>
            </div>
            
            <div class="flex items-center gap-2">
                <a id="signup-button" href="kaydol.html" class="bg-primary text-white px-4 py-2 rounded-lg text-sm font-semibold hover:opacity-90 transition-opacity" data-i18n="auth-signup">KayÄ±t Ol</a>
                <a id="login-button" href="giris.html" class="bg-gray-200 border border-gray-300 text-gray-900 px-4 py-2 rounded-lg text-sm font-semibold hover:bg-gray-300 transition-colors dark:bg-gray-700/50 dark:border-gray-600/80 dark:text-white dark:hover:bg-gray-700" data-i18n="auth-login">GiriÅŸ Yap</a>

                <div id="languageSelector" class="relative">
                    <button id="languageButton" class="flex cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 w-10 bg-gray-200 border border-gray-300 text-gray-900 transition-colors hover:bg-gray-300 dark:bg-gray-700/50 dark:border-gray-600/80 dark:text-white dark:hover:bg-gray-700">
                        <span class="material-symbols-outlined text-xl">language</span>
                    </button>
                    <div id="languageDropdown" class="absolute right-0 top-full pt-1 w-32 bg-white border border-gray-300 rounded-lg shadow-xl overflow-hidden z-20 hidden dark:bg-gray-800/80 dark:border-gray-700">
                        <a href="#" data-lang="tr" class="language-option block px-4 py-2 text-sm text-gray-900 font-medium hover:bg-primary/80 hover:text-white transition-colors duration-150 dark:text-gray-200">TÃ¼rkÃ§e (TR)</a>
                        <a href="#" data-lang="en" class="language-option block px-4 py-2 text-sm text-gray-900 font-medium hover:bg-primary/80 hover:text-white transition-colors duration-150 dark:text-gray-200">English (EN)</a>
                    </div>
                </div>

                <div id="account-section" class="relative hidden"> 
                    <button id="account_circle" class="flex material-icons-outlined items-center justify-center overflow-hidden rounded-lg h-10 w-10 bg-gray-200 border border-gray-300 text-gray-900 transition-colors hover:bg-gray-300 dark:bg-gray-700/50 dark:border-gray-600/80 dark:text-white dark:hover:bg-gray-700">
                        <span>account_circle</span>
                    </button>
                    <div id="profileDropdown" class="absolute right-0 top-full pt-1 w-48 bg-white border border-gray-300 rounded-lg shadow-xl overflow-hidden z-20 hidden dark:bg-gray-800/80 dark:border-gray-700">
                        <div class="px-4 py-3 border-b border-gray-200 dark:border-gray-700">
                            <p class="text-sm text-gray-600 dark:text-gray-400" data-i18n="auth-welcome">HoÅŸ geldin,</p>
                            <p id="welcome-username" class="text-sm font-medium text-gray-900 dark:text-white truncate">KullanÄ±cÄ±</p>
                        </div>
                        <a href="hesabim.html" class="block px-4 py-2 text-sm text-gray-900 font-medium hover:bg-primary/80 hover:text-white transition-colors duration-150 dark:text-gray-200" data-i18n="nav-profile">HesabÄ±m</a>
                        <a href="#" id="logout-button" class="block w-full text-left px-4 py-2 text-sm text-red-600 font-medium hover:bg-red-500 hover:text-white transition-colors duration-150 dark:text-red-400 dark:hover:bg-red-500/50">
                            <span data-i18n="auth-logout">Ã‡Ä±kÄ±ÅŸ Yap</span>
                        </a>
                    </div>
                </div>
                
                <button id="darkModeButton" class="grid place-items-center rounded-lg h-10 w-10 bg-gray-200 border border-gray-300 text-gray-900 transition-colors hover:bg-gray-300 dark:bg-gray-700/50 dark:border-gray-600/80 dark:text-white dark:hover:bg-gray-700 cursor-pointer overflow-hidden">
                    <span id="moonIcon" class="material-symbols-outlined col-start-1 row-start-1 transition-all duration-300 opacity-0 scale-75 rotate-90 dark:opacity-100 dark:scale-100 dark:rotate-0">
                        dark_mode
                    </span>
                    <span id="sunIcon" class="material-symbols-outlined col-start-1 row-start-1 transition-all duration-300 opacity-100 scale-100 rotate-0 dark:opacity-0 dark:scale-75 dark:-rotate-90">
                        light_mode
                    </span>
                </button>
            </div>
        </nav>
    </header>

    <main class="flex-grow container mx-auto px-4 py-8 md:py-12">
    <div class="text-center max-w-3xl mx-auto mb-12">
        <h1 class="text-3xl md:text-5xl font-bold text-gray-900 dark:text-white tracking-tight mb-4" data-i18n="main-title">
            PC Uyumluluk KontrolÃ¼
        </h1>
        <p class="text-lg text-gray-600 dark:text-gray-400" data-i18n="main-subtitle">
            Sisteminizi aÅŸaÄŸÄ±daki slotlara yerleÅŸtirin. Yapay zeka ve algoritmalarÄ±mÄ±z parÃ§alarÄ±nÄ±zÄ±n uyumunu anÄ±nda denetlesin.
        </p>
    </div>

<div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6 mb-12">
        
        <div class="component-card group relative bg-white dark:bg-gray-800 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-700 p-5 transition-all duration-300 hover:border-primary/50 hover:shadow-lg hover:shadow-primary/5">
            <div class="flex items-center gap-3 mb-3">
                <div class="p-2.5 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-blue-600 dark:text-blue-400">
                    <span class="material-symbols-outlined text-2xl">memory</span>
                </div>
                <h3 class="font-semibold text-gray-900 dark:text-white" data-i18n="label-cpu">Ä°ÅŸlemci</h3>
            </div>
            
            <div class="custom-select-wrapper" id="wrapper-cpu">
                <select id="cpu" class="hidden" onchange="handleSelectionChange(event)">
                    <option value="" data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</option>
                </select>

                <div class="custom-select-trigger" onclick="toggleCustomDropdown('cpu')">
                    <span class="selection-text truncate select-none text-gray-500 dark:text-gray-400" data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</span>
                    <div class="flex items-center">
                        <button class="clear-btn" onclick="clearCustomSelection('cpu', event)">
                            <span class="material-symbols-outlined text-sm font-bold">close</span>
                        </button>
                        <span class="material-symbols-outlined text-gray-500 arrow-icon">expand_more</span>
                    </div>
                </div>

                <div class="custom-select-options">
                    <div class="custom-search-box">
                        <input type="text" data-i18n-placeholder="search-title" onkeyup="filterCustomOptions('cpu', this.value)" onclick="event.stopPropagation()">
                    </div>
                    <div class="custom-options-list" id="list-cpu">
                        <div class="p-3 text-center text-xs text-gray-400"data-i18n="loading-data">Veriler YÃ¼kleniyor...</div>
                    </div>
                </div>
            </div>
            <p id="error-cpu" class="hidden mt-2 text-xs text-red-500 font-medium flex items-center gap-1">
                <span class="material-symbols-outlined text-[14px]">error</span> <span class="error-text"></span>
            </p>
        </div>

        <div class="component-card group relative bg-white dark:bg-gray-800 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-700 p-5 transition-all duration-300 hover:border-primary/50 hover:shadow-lg hover:shadow-primary/5">
            <div class="flex items-center gap-3 mb-3">
                <div class="p-2.5 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg text-indigo-600 dark:text-indigo-400">
                    <span class="material-symbols-outlined text-2xl">developer_board</span>
                </div>
                <h3 class="font-semibold text-gray-900 dark:text-white" data-i18n="label-motherboard">Anakart</h3>
            </div>
            
            <div class="custom-select-wrapper" id="wrapper-motherboard">
                <select id="motherboard" class="hidden" onchange="handleSelectionChange(event)">
                    <option value=""data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</option>
                </select>

                <div class="custom-select-trigger" onclick="toggleCustomDropdown('motherboard')">
                    <span class="selection-text truncate select-none text-gray-500 dark:text-gray-400"data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</span>
                    <div class="flex items-center">
                        <button class="clear-btn" onclick="clearCustomSelection('motherboard', event)">
                            <span class="material-symbols-outlined text-sm font-bold">close</span>
                        </button>
                        <span class="material-symbols-outlined text-gray-500 arrow-icon">expand_more</span>
                    </div>
                </div>

                <div class="custom-select-options">
                    <div class="custom-search-box">
                        <input type="text"  data-i18n-placeholder="search-title" onkeyup="filterCustomOptions('motherboard', this.value)" onclick="event.stopPropagation()">
                    </div>
                    <div class="custom-options-list" id="list-motherboard">
                        <div class="p-3 text-center text-xs text-gray-400"data-i18n="loading-data">Veriler YÃ¼kleniyor...</div>
                    </div>
                </div>
            </div>
            <p id="error-motherboard" class="hidden mt-2 text-xs text-red-500 font-medium flex items-center gap-1">
                <span class="material-symbols-outlined text-[14px]">error</span> <span class="error-text"></span>
            </p>
        </div>

        <div class="component-card group relative bg-white dark:bg-gray-800 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-700 p-5 transition-all duration-300 hover:border-primary/50 hover:shadow-lg hover:shadow-primary/5">
            <div class="flex items-center gap-3 mb-3">
                <div class="p-2.5 bg-green-50 dark:bg-green-900/20 rounded-lg text-green-600 dark:text-green-400">
                    <span class="material-symbols-outlined text-2xl">straighten</span> </div>
                <h3 class="font-semibold text-gray-900 dark:text-white" data-i18n="label-ram">Bellek (RAM)</h3>
            </div>
            
            <div class="custom-select-wrapper" id="wrapper-ram">
                <select id="ram" class="hidden" onchange="handleSelectionChange(event)">
                    <option value=""data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</option>
                </select>

                <div class="custom-select-trigger" onclick="toggleCustomDropdown('ram')">
                    <span class="selection-text truncate select-none text-gray-500 dark:text-gray-400"data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</span>
                    <div class="flex items-center">
                        <button class="clear-btn" onclick="clearCustomSelection('ram', event)">
                            <span class="material-symbols-outlined text-sm font-bold">close</span>
                        </button>
                        <span class="material-symbols-outlined text-gray-500 arrow-icon">expand_more</span>
                    </div>
                </div>

                <div class="custom-select-options">
                    <div class="custom-search-box">
                        <input type="text" data-i18n-placeholder="search-title" onkeyup="filterCustomOptions('ram', this.value)" onclick="event.stopPropagation()">
                    </div>
                    <div class="custom-options-list" id="list-ram">
                        <div class="p-3 text-center text-xs text-gray-400"data-i18n="loading-data">Veriler YÃ¼kleniyor...</div>
                    </div>
                </div>
            </div>
            <p id="error-ram" class="hidden mt-2 text-xs text-red-500 font-medium flex items-center gap-1">
                <span class="material-symbols-outlined text-[14px]">error</span> <span class="error-text"></span>
            </p>
        </div>

        <div class="component-card group relative bg-white dark:bg-gray-800 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-700 p-5 transition-all duration-300 hover:border-primary/50 hover:shadow-lg hover:shadow-primary/5">
            <div class="flex items-center gap-3 mb-3">
                <div class="p-2.5 bg-purple-50 dark:bg-purple-900/20 rounded-lg text-purple-600 dark:text-purple-400">
                    <span class="material-symbols-outlined text-2xl">videogame_asset</span>
                </div>
                <h3 class="font-semibold text-gray-900 dark:text-white" data-i18n="type-gpu">Ekran KartÄ±</h3>
            </div>
            
            <div class="custom-select-wrapper" id="wrapper-gpu">
                <select id="gpu" class="hidden" onchange="handleSelectionChange(event)">
                    <option value=""data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</option>
                </select>

                <div class="custom-select-trigger" onclick="toggleCustomDropdown('gpu')">
                    <span class="selection-text truncate select-none text-gray-500 dark:text-gray-400"data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</span>
                    <div class="flex items-center">
                        <button class="clear-btn" onclick="clearCustomSelection('gpu', event)">
                            <span class="material-symbols-outlined text-sm font-bold">close</span>
                        </button>
                        <span class="material-symbols-outlined text-gray-500 arrow-icon">expand_more</span>
                    </div>
                </div>

                <div class="custom-select-options">
                    <div class="custom-search-box">
                        <input type="text" data-i18n-placeholder="search-title" onkeyup="filterCustomOptions('gpu', this.value)" onclick="event.stopPropagation()">
                    </div>
                    <div class="custom-options-list" id="list-gpu">
                        <div class="p-3 text-center text-xs text-gray-400"data-i18n="loading-data">Veriler YÃ¼kleniyor...</div>
                    </div>
                </div>
            </div>
            <p id="error-gpu" class="hidden mt-2 text-xs text-red-500 font-medium flex items-center gap-1">
                <span class="material-symbols-outlined text-[14px]">error</span> <span class="error-text"></span>
            </p>
        </div>

        <div class="component-card group relative bg-white dark:bg-gray-800 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-700 p-5 transition-all duration-300 hover:border-primary/50 hover:shadow-lg hover:shadow-primary/5">
            <div class="flex items-center gap-3 mb-3">
                <div class="p-2.5 bg-orange-50 dark:bg-orange-900/20 rounded-lg text-orange-600 dark:text-orange-400">
                    <span class="material-symbols-outlined text-2xl">hard_drive</span>
                </div>
                <h3 class="font-semibold text-gray-900 dark:text-white" data-i18n="type-storage">Depolama</h3>
            </div>
            
            <div class="custom-select-wrapper" id="wrapper-storage">
                <select id="storage" class="hidden" onchange="handleSelectionChange(event)">
                    <option value=""data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</option>
                </select>

                <div class="custom-select-trigger" onclick="toggleCustomDropdown('storage')">
                    <span class="selection-text truncate select-none text-gray-500 dark:text-gray-400"data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</span>
                    <div class="flex items-center">
                        <button class="clear-btn" onclick="clearCustomSelection('storage', event)">
                            <span class="material-symbols-outlined text-sm font-bold">close</span>
                        </button>
                        <span class="material-symbols-outlined text-gray-500 arrow-icon">expand_more</span>
                    </div>
                </div>

                <div class="custom-select-options">
                    <div class="custom-search-box">
                        <input type="text" data-i18n-placeholder="search-title" onkeyup="filterCustomOptions('storage', this.value)" onclick="event.stopPropagation()">
                    </div>
                    <div class="custom-options-list" id="list-storage">
                        <div class="p-3 text-center text-xs text-gray-400"data-i18n="loading-data">Veriler YÃ¼kleniyor...</div>
                    </div>
                </div>
            </div>
            <p id="error-storage" class="hidden mt-2 text-xs text-red-500 font-medium flex items-center gap-1">
                <span class="material-symbols-outlined text-[14px]">error</span> <span class="error-text"></span>
            </p>
        </div>

        <div class="component-card group relative bg-white dark:bg-gray-800 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-700 p-5 transition-all duration-300 hover:border-primary/50 hover:shadow-lg hover:shadow-primary/5">
            <div class="flex items-center gap-3 mb-3">
                <div class="p-2.5 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300">
                    <span class="material-symbols-outlined text-2xl">computer</span>
                </div>
                <h3 class="font-semibold text-gray-900 dark:text-white" data-i18n="tab-case">Kasa</h3>
            </div>
            
            <div class="custom-select-wrapper" id="wrapper-case">
                <select id="case" class="hidden" onchange="handleSelectionChange(event)">
                    <option value=""data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</option>
                </select>

                <div class="custom-select-trigger" onclick="toggleCustomDropdown('case')">
                    <span class="selection-text truncate select-none text-gray-500 dark:text-gray-400"data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</span>
                    <div class="flex items-center">
                        <button class="clear-btn" onclick="clearCustomSelection('case', event)">
                            <span class="material-symbols-outlined text-sm font-bold">close</span>
                        </button>
                        <span class="material-symbols-outlined text-gray-500 arrow-icon">expand_more</span>
                    </div>
                </div>

                <div class="custom-select-options">
                    <div class="custom-search-box">
                        <input type="text" data-i18n-placeholder="search-title" onkeyup="filterCustomOptions('case', this.value)" onclick="event.stopPropagation()">
                    </div>
                    <div class="custom-options-list" id="list-case">
                        <div class="p-3 text-center text-xs text-gray-400"data-i18n="loading-data">Veriler YÃ¼kleniyor...</div>
                    </div>
                </div>
            </div>
            <p id="error-case" class="hidden mt-2 text-xs text-red-500 font-medium flex items-center gap-1">
                <span class="material-symbols-outlined text-[14px]">error</span> <span class="error-text"></span>
            </p>
        </div>

        <div class="component-card group relative bg-white dark:bg-gray-800 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-700 p-5 transition-all duration-300 hover:border-primary/50 hover:shadow-lg hover:shadow-primary/5">
            <div class="flex items-center gap-3 mb-3">
                <div class="p-2.5 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg text-yellow-600 dark:text-yellow-400">
                    <span class="material-symbols-outlined text-2xl">power</span>
                </div>
                <h3 class="font-semibold text-gray-900 dark:text-white" data-i18n="label-psu">GÃ¼Ã§ KaynaÄŸÄ±</h3>
            </div>
            
            <div class="custom-select-wrapper" id="wrapper-psu">
                <select id="psu" class="hidden" onchange="handleSelectionChange(event)">
                    <option value=""data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</option>
                </select>

                <div class="custom-select-trigger" onclick="toggleCustomDropdown('psu')">
                    <span class="selection-text truncate select-none text-gray-500 dark:text-gray-400"data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</span>
                    <div class="flex items-center">
                        <button class="clear-btn" onclick="clearCustomSelection('psu', event)">
                            <span class="material-symbols-outlined text-sm font-bold">close</span>
                        </button>
                        <span class="material-symbols-outlined text-gray-500 arrow-icon">expand_more</span>
                    </div>
                </div>

                <div class="custom-select-options">
                    <div class="custom-search-box">
                        <input type="text" data-i18n-placeholder="search-title" onkeyup="filterCustomOptions('psu', this.value)" onclick="event.stopPropagation()">
                    </div>
                    <div class="custom-options-list" id="list-psu">
                        <div class="p-3 text-center text-xs text-gray-400"data-i18n="loading-data">Veriler YÃ¼kleniyor...</div>
                    </div>
                </div>
            </div>
            <p id="error-psu" class="hidden mt-2 text-xs text-red-500 font-medium flex items-center gap-1">
                <span class="material-symbols-outlined text-[14px]">error</span> <span class="error-text"></span>
            </p>
        </div>

        <div class="component-card group relative bg-white dark:bg-gray-800 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-700 p-5 transition-all duration-300 hover:border-primary/50 hover:shadow-lg hover:shadow-primary/5">
            <div class="flex items-center gap-3 mb-3">
                <div class="p-2.5 bg-cyan-50 dark:bg-cyan-900/20 rounded-lg text-cyan-600 dark:text-cyan-400">
                    <span class="material-symbols-outlined text-2xl">mode_fan</span>
                </div>
                <h3 class="font-semibold text-gray-900 dark:text-white" data-i18n="type-cooler">SoÄŸutucu</h3>
            </div>
            
            <div class="custom-select-wrapper" id="wrapper-cpuCooler">
                <select id="cpuCooler" class="hidden" onchange="handleSelectionChange(event)">
                    <option value=""data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</option>
                </select>

                <div class="custom-select-trigger" onclick="toggleCustomDropdown('cpuCooler')">
                    <span class="selection-text truncate select-none text-gray-500 dark:text-gray-400"data-i18n="select-default">SeÃ§im YapÄ±nÄ±z...</span>
                    <div class="flex items-center">
                        <button class="clear-btn" onclick="clearCustomSelection('cpuCooler', event)">
                            <span class="material-symbols-outlined text-sm font-bold">close</span>
                        </button>
                        <span class="material-symbols-outlined text-gray-500 arrow-icon">expand_more</span>
                    </div>
                </div>

                <div class="custom-select-options">
                    <div class="custom-search-box">
                        <input type="text" data-i18n-placeholder="search-title" onkeyup="filterCustomOptions('cpuCooler', this.value)" onclick="event.stopPropagation()">
                    </div>
                    <div class="custom-options-list" id="list-cpuCooler">
                        <div class="p-3 text-center text-xs text-gray-400"data-i18n="loading-data">Veriler YÃ¼kleniyor...</div>
                    </div>
                </div>
            </div>
            <p id="error-cpuCooler" class="hidden mt-2 text-xs text-red-500 font-medium flex items-center gap-1">
                <span class="material-symbols-outlined text-[14px]">error</span> <span class="error-text"></span>
            </p>
        </div>

    </div>

    <div class="text-center mb-12">
        <button id="checkCompatibilityBtn" class="bg-primary text-white font-bold py-3.5 px-10 rounded-xl text-lg hover:bg-primary/90 hover:scale-105 transition-all shadow-xl shadow-primary/25" data-i18n="action-check">
            UyumluluÄŸu Kontrol Et
        </button>
        <button id="expertOpinionButton" class="bg-indigo-600 text-white font-bold py-3.5 px-10 rounded-xl text-lg hover:bg-indigo-700 hover:scale-105 transition-all shadow-xl shadow-indigo-600/30 disabled:opacity-50 disabled:hover:scale-100 mt-4 md:mt-0 md:ml-4" disabled data-i18n="action-expert">
            ParÃ§a Uzman GÃ¶rÃ¼ÅŸÃ¼ Al âœ¨
        </button>
    </div>

    <div class="max-w-5xl mx-auto mt-8">
        <div id="results-container" class="bg-white dark:bg-gray-800/80 backdrop-blur-xl p-6 md:p-8 rounded-2xl border border-gray-200 dark:border-gray-700 shadow-xl transition-all duration-300">
            
            <div class="flex items-center gap-3 mb-6 border-b border-gray-100 dark:border-gray-700 pb-4">
                <div class="p-2 bg-primary/10 rounded-lg">
                    <span class="material-symbols-outlined text-primary text-2xl">analytics</span>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white" data-i18n="results-title">Kontrol SonuÃ§larÄ±</h2>
            </div>

            <div id="result-info" class="flex flex-col md:flex-row items-center gap-5 p-6 rounded-xl bg-blue-50 border border-blue-100 dark:bg-blue-900/20 dark:border-blue-800/30 transition-all">
                <div class="flex-shrink-0 p-4 bg-blue-100 dark:bg-blue-600/20 rounded-full shadow-sm">
                    <span class="material-symbols-outlined text-3xl text-blue-600 dark:text-blue-400">info</span>
                </div>
                <div class="text-center md:text-left">
                    <h3 class="text-lg font-bold text-blue-900 dark:text-blue-100" data-i18n="result-info-title">Sistem HazÄ±r Bekliyor</h3>
                    <p class="mt-1 text-blue-700 dark:text-blue-300/80 text-sm font-medium leading-relaxed" data-i18n="result-info-text">
                        Analize baÅŸlamak iÃ§in yukarÄ±daki slotlara en az iki parÃ§a (Ã–rn: Ä°ÅŸlemci ve Anakart) yerleÅŸtirin.
                    </p>
                </div>
            </div>

            <div id="result-success" class="hidden flex-col md:flex-row items-center gap-5 p-6 rounded-xl bg-emerald-50 border border-emerald-100 dark:bg-emerald-900/20 dark:border-emerald-800/30 transition-all shadow-[0_0_20px_rgba(16,185,129,0.15)]">
                <div class="flex-shrink-0 p-4 bg-emerald-100 dark:bg-emerald-500/20 rounded-full shadow-sm">
                    <span class="material-symbols-outlined text-3xl text-emerald-600 dark:text-emerald-400">verified</span>
                </div>
                <div class="text-center md:text-left flex-grow">
                    <h3 class="text-lg font-bold text-emerald-900 dark:text-emerald-100" data-i18n="result-success-title">MÃ¼kemmel Uyum!</h3>
                    <p id="success-text" class="mt-1 text-emerald-700 dark:text-emerald-300 text-sm font-medium leading-relaxed"></p>
                </div>
            </div>
            
            <div id="result-fail" class="hidden flex-col md:flex-row items-start gap-5 p-6 rounded-xl bg-red-50 border border-red-100 dark:bg-red-900/10 dark:border-red-800/30 transition-all shadow-[0_0_20px_rgba(239,68,68,0.15)]">
                <div class="flex-shrink-0 p-4 bg-red-100 dark:bg-red-500/20 rounded-full shadow-sm hidden md:block">
                    <span class="material-symbols-outlined text-3xl text-red-600 dark:text-red-400">warning</span>
                </div>
                <div class="w-full">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="material-symbols-outlined text-3xl text-red-600 dark:text-red-400 md:hidden">warning</span>
                        <h3 class="text-lg font-bold text-red-900 dark:text-red-100" data-i18n="result-fail-title">Uyumsuzluk Tespit Edildi</h3>
                    </div>
                    <ul id="fail-reasons" class="space-y-3"></ul>
                </div>
            </div>

        </div>
    </div>
</main>

    <footer class="w-full mt-20 py-8 border-t border-gray-200 dark:border-gray-800">
        <div class="container mx-auto text-center text-gray-500 dark:text-gray-400 text-sm">
            <p>Â© 2025 PCPartsBuild. TÃ¼m HaklarÄ± SaklÄ±dÄ±r. Bize UlaÅŸÄ±n: <a class="text-primary hover:underline" href="mailto:pcpartsbuild@gmail.com">pcpartsbuild@gmail.com</a></p>
        </div>
    </footer>
</div>

<div id="geminiModal" class="fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center p-4 hidden z-50">
    <div class="bg-white dark:bg-gray-900 rounded-xl shadow-2xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto">
        <div class="flex justify-between items-center border-b pb-3 mb-4 border-gray-200 dark:border-gray-700">
            <h3 id="modalTitle" class="text-xl font-bold text-gray-900 dark:text-white" data-i18n="action-expert">ParÃ§a Uzman GÃ¶rÃ¼ÅŸÃ¼ Al</h3>
            <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>
        <div id="modalContent" class="text-gray-700 dark:text-gray-300 whitespace-pre-wrap"></div>
    </div>
</div>

<script>
    // 1. Ã–nce deÄŸiÅŸkeni boÅŸ tanÄ±mlÄ±yoruz
let GEMINI_API_KEY = "";

// 2. Dosyadan anahtarÄ± Ã§eken fonksiyon
async function loadApiKey() {
    try {
        const response = await fetch('api.txt');
        const key = await response.text();
        GEMINI_API_KEY = key.trim(); // BoÅŸluklarÄ± temizleyip deÄŸiÅŸkene atÄ±yoruz
        console.log("API AnahtarÄ± baÅŸarÄ±yla yÃ¼klendi.");
        
        // API anahtarÄ± yÃ¼klendikten sonra Ã§alÄ±ÅŸacak fonksiyonu burada Ã§aÄŸÄ±rabilirsin
        // startApp(); 
    } catch (error) {
        console.error("API anahtarÄ± okunurken hata oluÅŸtu:", error);
    }
}

// Sayfa yÃ¼klendiÄŸinde anahtarÄ± Ã§ek
loadApiKey();
    // Axios kÃ¼tÃ¼phanesini dahil et
    document.write('<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></' + 'script>');

    // ==========================================
    // 1. AYARLAR VE Ã‡EVÄ°RÄ°LER
    // ==========================================
    
    // API AyarlarÄ±
    const API_BASE_URL = "https://pcpartsbuild.com"; // Senin API adresin
    const GEMINI_API_URL = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=";


    // Endpoint EÅŸleÅŸmeleri
    const endpoints = {
        cpu: 'processors',
        motherboard: 'motherboards',
        ram: 'rams',
        gpu: 'gpus',
        storage: 'storages',
        case: 'cases',
        psu: 'psus',
        cpuCooler: 'cpuCoolers'
    };

    // SeÃ§ilen ParÃ§alar (Global HafÄ±za)
    let selectedParts = {
        cpu: null, motherboard: null, ram: null, gpu: null,
        storage: null, case: null, psu: null, cpuCooler: null
    };

    // Ã‡eviri SÃ¶zlÃ¼ÄŸÃ¼
    const translations = {
        tr: {
            "app-title": "PC ParÃ§a Uyumluluk KontrolÃ¼",
            "nav-wizard": "PC Toplama SihirbazÄ±",
            "nav-compatibility": "ParÃ§a Uyumluluk KontrolÃ¼",
            "nav-info": "PC BileÅŸenleri",
            "ai-analiz":"Yapay Zeka Analiz Ediyor...",
            "auth-signup": "KayÄ±t Ol",
            "auth-login": "GiriÅŸ Yap",
            "auth-welcome": "HoÅŸ geldin,",
            "loading-data":"Veriler YÃ¼kleniyor...",
            "nav-profile": "HesabÄ±m",
            "auth-logout": "Ã‡Ä±kÄ±ÅŸ Yap",
            "main-title": "PC ParÃ§a Uyumluluk KontrolÃ¼",
            "main-subtitle": "Sisteminizi aÅŸaÄŸÄ±daki slotlara yerleÅŸtirin. Yapay zeka ve algoritmalarÄ±mÄ±z parÃ§alarÄ±nÄ±zÄ±n uyumunu anÄ±nda denetlesin.",
            "label-cpu": "Ä°ÅŸlemci",
            "label-motherboard": "Anakart",
            "label-ram": "Bellek (RAM)",
            "label-psu": "GÃ¼Ã§ KaynaÄŸÄ±",
            "type-gpu": "Ekran KartÄ±",
            "type-storage": "Depolama",
            "type-cooler": "SoÄŸutucu",
            "tab-case": "Kasa",
            "select-default": "SeÃ§im YapÄ±nÄ±z...",
            "search-title":"ara...",
            "action-check": "UyumluluÄŸu Kontrol Et",
            "action-expert": "ParÃ§a Uzman GÃ¶rÃ¼ÅŸÃ¼ Al âœ¨",
            "results-title": "Kontrol SonuÃ§larÄ±",
            "result-info-title": "Sistem HazÄ±r Bekliyor",
            "result-info-text": "Analize baÅŸlamak iÃ§in yukarÄ±daki slotlara en az iki parÃ§a (Ã–rn: Ä°ÅŸlemci ve Anakart) yerleÅŸtirin.",
            "result-success-title": "MÃ¼kemmel Uyum!",
            "result-fail-title": "Uyumsuzluk Tespit Edildi",
            "error-selection": "LÃ¼tfen analiz iÃ§in en az 2 parÃ§a seÃ§in.",
            "loading-text": "Analiz ediliyor...",
            "error-api": "Analiz alÄ±namadÄ±. LÃ¼tfen daha sonra tekrar deneyin.",
            "analysis-prompt-title": "AÅŸaÄŸÄ±daki seÃ§ili sistem parÃ§alarÄ±nÄ± birbiriyle uyumluluk, darboÄŸaz ve performans aÃ§Ä±sÄ±ndan teknik bir uzman diliyle analiz et. Markdown formatÄ±nda yanÄ±tla."
        },
        en: {
            "app-title": "PC Part Compatibility Check",
            "nav-wizard": "PC Build Wizard",
            "nav-compatibility": "Part Compatibility Check",
            "nav-info": "PC Components",
            "auth-signup": "Sign Up",
            "auth-login": "Log In",
            "auth-welcome": "Welcome,",
            "nav-profile": "My Account",
            "auth-logout": "Log Out",
            "main-title": "PC Part Compatibility Check",
            "main-subtitle": "Place your system components in the slots below. Our AI and algorithms will instantly check for compatibility.",
            "label-cpu": "Processor",
            "label-motherboard": "Motherboard",
            "ai-analiz":"AI is Analyzing...",
            "label-ram": "Memory (RAM)",
            "label-psu": "Power Supply",
            "loading-data":"Loading Data...",
            "type-gpu": "Graphics Card",
            "type-storage": "Storage",
            "type-cooler": "Cooler",
            "tab-case": "Case",
            "select-default": "Select...",
            "search-title":"Search...",
            "action-check": "Check Compatibility",
            "action-expert": "Get Expert Opinion âœ¨",
            "results-title": "Check Results",
            "result-info-title": "System Ready",
            "result-info-text": "To start analysis, place at least two components (e.g., CPU and Motherboard) into the slots above.",
            "result-success-title": "Perfect Match!",
            "result-fail-title": "Incompatibility Detected",
            "error-selection": "Please select at least 2 parts for analysis.",
            "loading-text": "Analyzing...",
            "error-api": "Could not retrieve analysis. Please try again later.",
            "analysis-prompt-title": "Analyze the selected system components below for compatibility, bottlenecks, and performance using technical expert language. Respond in Markdown format."
        }
    };

    // ==========================================
    // 2. TEMA VE DÄ°L YÃ–NETÄ°MÄ°
    // ==========================================

    const setLanguage = (lang) => {
        localStorage.setItem('lang', lang);
        document.documentElement.lang = lang;
        
        // Metinleri gÃ¼ncelle
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            const translation = translations[lang][key];
            if (translation) element.textContent = translation;
        });

        // Placeholder'larÄ± gÃ¼ncelle
        document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
            const key = element.getAttribute('data-i18n-placeholder');
            const translation = translations[lang][key];
            if (translation) element.placeholder = translation;
        });

        // Dropdown VarsayÄ±lan YazÄ±larÄ±nÄ± gÃ¼ncelle
        const defaultText = translations[lang]['select-default'];
        document.querySelectorAll('select').forEach(select => {
            if (select.options.length > 0 && select.options[0].value === "") {
                select.options[0].text = defaultText;
            }
        });

        checkExpertButtonStatus(); // Buton durumunu kontrol et
    };

// Tema AyarlarÄ± - DÃœZELTÄ°LMÄ°Åž HALÄ°
    const toggleDarkMode = () => {
        const html = document.documentElement;
        const sunIcon = document.getElementById('sunIcon');
        const moonIcon = document.getElementById('moonIcon');
        // NOT: account_circle butonu artÄ±k manuel olarak burada deÄŸiÅŸtirilmiyor.
        // Tailwind'in "dark:" sÄ±nÄ±flarÄ± bu iÅŸi hallediyor.
        
        const isDarkMode = html.classList.contains('dark');
        const newTheme = isDarkMode ? 'light' : 'dark';

        if (isDarkMode) {
            html.classList.remove('dark');
        } else {
            html.classList.add('dark');
        }
        localStorage.setItem('theme_builder', newTheme);
        
        if (sunIcon && moonIcon) {
            if (newTheme === 'light') {
                moonIcon.classList.remove('opacity-100', 'scale-100');
                moonIcon.classList.add('opacity-0', 'scale-75');
                sunIcon.classList.remove('opacity-0', 'scale-75');
                sunIcon.classList.add('opacity-100', 'scale-100'); 
            } else {
                sunIcon.classList.remove('opacity-100', 'scale-100'); 
                sunIcon.classList.add('opacity-0', 'scale-75'); 
                moonIcon.classList.remove('opacity-0', 'scale-75');
                moonIcon.classList.add('opacity-100', 'scale-100');
            }
        }
    };

    const initializeTheme = (key = 'theme_builder') => {
        const html = document.documentElement;
        const savedTheme = localStorage.getItem(key);
        const sunIcon = document.getElementById('sunIcon');
        const moonIcon = document.getElementById('moonIcon');
        // NOT: account_circle butonu artÄ±k manuel olarak burada deÄŸiÅŸtirilmiyor.

        let isDark = false;
        if (savedTheme === 'dark') {
            html.classList.add('dark');
            isDark = true;
        } else if (savedTheme === 'light') {
            html.classList.remove('dark');
            isDark = false;
        } else if (html.classList.contains('dark')) {
            localStorage.setItem(key, 'dark');
            isDark = true;
        } else {
            localStorage.setItem(key, 'light');
            isDark = false;
        }

        if (sunIcon && moonIcon) {
            if (isDark) {
                moonIcon.classList.add('opacity-100', 'scale-100');
                sunIcon.classList.add('opacity-0', 'scale-75');
            } else {
                sunIcon.classList.add('opacity-100', 'scale-100');
                moonIcon.classList.add('opacity-0', 'scale-75');
            }
        }
    };

    const initializeLang = () => {
        const savedLang = localStorage.getItem('lang');
        let currentLang = savedLang || document.documentElement.lang || 'tr';
        setLanguage(currentLang);
    };
    // ==========================================
    // 3. UZMAN GÃ–RÃœÅžÃœ (GEMINI API)
    // ==========================================

    const getModalElements = () => ({
        modal: document.getElementById('geminiModal'),
        modalContent: document.getElementById('modalContent'),
        modalTitle: document.getElementById('modalTitle')
    });

    // Modal AÃ§/Kapa (Ã‡eviri Uyumlu)
const openModal = (title, content, isLoading = false) => {
    const { modal, modalTitle, modalContent } = getModalElements();
    
    // 1. O anki dili al (varsayÄ±lan tr)
    const currentLang = localStorage.getItem('lang') || 'tr';
    
    // 2. SÃ¶zlÃ¼kten ilgili Ã§eviriyi Ã§ek
    // translations[currentLang]['ai-analiz'] -> "Yapay Zeka Analiz Ediyor..." veya "AI is Analyzing..."
    const loadingText = translations[currentLang]['ai-analiz'];

    modalTitle.textContent = title;
    modalContent.innerHTML = isLoading 
        ? `<div class="flex items-center justify-center space-x-2 text-primary py-8">
               <svg class="animate-spin h-6 w-6 mr-3" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none" class="opacity-25"></circle><path fill="currentColor" class="opacity-75" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
               <span class="text-lg animate-pulse" data-i18n="ai-analiz">${loadingText}</span>
             </div>`
        : content;
    modal.classList.remove('hidden');
};

    window.closeModal = () => {
        document.getElementById('geminiModal').classList.add('hidden');
    };

    // API Ä°steÄŸi
    const callGeminiAPI = async (prompt) => {
        try {
            const payload = {
                contents: [{ parts: [{ text: prompt }] }]
            };
            const response = await fetch(GEMINI_API_URL + GEMINI_API_KEY, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            
            const result = await response.json();
            return result.candidates?.[0]?.content?.parts?.[0]?.text || "YanÄ±t alÄ±namadÄ±.";
        } catch (error) {
            console.error("Gemini API Error:", error);
            return translations[localStorage.getItem('lang') || 'tr']['error-api'];
        }
    };

    // Uzman GÃ¶rÃ¼ÅŸÃ¼ Al Butonu
    const getExpertOpinion = async () => {
        const currentLang = localStorage.getItem('lang') || 'tr';
        
        // SeÃ§ili parÃ§alarÄ± listele
        const partsList = [];
        for (const [key, value] of Object.entries(selectedParts)) {
            if (value) {
                const label = translations[currentLang][`label-${key}`] || translations[currentLang][`type-${key}`] || translations[currentLang][`tab-${key}`] || key;
                partsList.push(`- **${label}:** ${value.brand} ${value.modelName}`);
            }
        }

        if (partsList.length < 2) {
            Swal.fire({
                title: 'Eksik Bilgi',
                text: translations[currentLang]['error-selection'],
                icon: 'warning',
                background: '#1f2937', color: '#fff', confirmButtonColor: '#16a3b2'
            });
            return;
        }

        // --- GÃœNCELLEME BURADA BAÅžLIYOR ---
        
        // Daha sÄ±kÄ± ve net talimatlar iÃ§eren ek prompt
        let strictInstructions = "";
        
        if (currentLang === 'tr') {
            strictInstructions = `
            YUKARIDAKÄ° PARÃ‡ALAR Ä°Ã‡Ä°N ANALÄ°Z TALÄ°MATLARI:
            1. YanÄ±tÄ± Ã§ok KISA, Ã–Z ve NET tut. Uzun paragraflardan kaÃ§Ä±n.
            2. Teknik jargon kullan ama amatÃ¶r bir kullanÄ±cÄ±nÄ±n anlayacaÄŸÄ± dilde olsun.
            3. YanÄ±tÄ± sadece ÅŸu 3 kÄ±sa madde baÅŸlÄ±ÄŸÄ± altÄ±nda topla:
               - ðŸŸ¢ **Genel Uyum:** (Uyumlu olup olmadÄ±ÄŸÄ±nÄ± tek cÃ¼mleyle belirt)
               - âš ï¸ **DarboÄŸaz/Risk:** (Varsa darboÄŸazÄ± veya PSU yetersizliÄŸini belirt, yoksa 'Sorun yok' de)
               - ðŸš€ **Performans Tahmini:** (Hangi Ã§Ã¶zÃ¼nÃ¼rlÃ¼kte/ayarlarda oyun oynatacaÄŸÄ±nÄ± 1-2 cÃ¼mleyle Ã¶zetle)
            4. Toplam yanÄ±t 150 kelimeyi geÃ§mesin.
            `;
        } else {
            strictInstructions = `
            ANALYSIS INSTRUCTIONS:
            1. Keep the response VERY SHORT, CONCISE, and CLEAR. Avoid long paragraphs.
            2. Use technical terms but keep it understandable for average users.
            3. Structure the response strictly under these 3 bullet points:
               - ðŸŸ¢ **Overall Compatibility:** (State compatibility in one sentence)
               - âš ï¸ **Bottlenecks/Risks:** (Mention bottlenecks or PSU issues if any, otherwise say 'No issues')
               - ðŸš€ **Performance Estimate:** (Summarize gaming performance/resolution in 1-2 sentences)
            4. Total response must not exceed 150 words.
            `;
        }

        // Eski prompt baÅŸlÄ±ÄŸÄ± ile yeni sÄ±kÄ± talimatlarÄ± ve parÃ§a listesini birleÅŸtiriyoruz
        const prompt = `${translations[currentLang]['analysis-prompt-title']}\n${strictInstructions}\n\nSÄ°STEM PARÃ‡ALARI:\n${partsList.join('\n')}`;
        
        // --- GÃœNCELLEME BURADA BÄ°TÄ°YOR ---

        openModal(translations[currentLang]['action-expert'], '', true);
        const resultText = await callGeminiAPI(prompt);
        
        // Markdown formatÄ±nÄ± basit HTML'e Ã§evir
        const formattedText = resultText
            .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>') // Bold yapma
            .replace(/\n/g, '<br>'); // SatÄ±r atlama
            
        openModal(translations[currentLang]['action-expert'], formattedText);
    };

    // Buton Aktif/Pasif KontrolÃ¼
    const checkExpertButtonStatus = () => {
        const expertButton = document.getElementById('expertOpinionButton');
        if (!expertButton) return;

        // En az 2 parÃ§a seÃ§ili mi kontrol et
        const selectedCount = Object.values(selectedParts).filter(p => p !== null).length;
        expertButton.disabled = selectedCount < 2;
    };


    // ==========================================
    // 4. VERÄ° Ã‡EKME MOTORU (LAZY LOAD)
    // ==========================================

    function initializeData() {
        console.log("âš¡ Lazy Load Modu Aktif.");
        
        const dropdowns = document.querySelectorAll('select');
        dropdowns.forEach(dropdown => {
            if (endpoints[dropdown.id]) {
                // TÄ±klayÄ±nca Veri Ã‡ek
                dropdown.addEventListener('focus', function() {
                    if (this.dataset.loaded !== "true") {
                        loadComponentData(this.id);
                    }
                });

                // SeÃ§im DeÄŸiÅŸince
                dropdown.addEventListener('change', handleSelectionChange);
            }
    
        });
    }


    async function loadComponentData(category) {
        const selectElement = document.getElementById(category);
        if (!selectElement) return;

        const defaultOption = selectElement.options[0];
        const originalText = defaultOption.text;
        defaultOption.text = "Veriler YÃ¼kleniyor... â³";
        
        const cacheKey = `puk_cache_${category}`;
        const cachedData = localStorage.getItem(cacheKey);
        const CACHE_DURATION = 5 * 60 * 1000;

        try {
            let data = null;
            let isFresh = false;

            if (cachedData) {
                const parsed = JSON.parse(cachedData);
                if (Date.now() - parsed.timestamp < CACHE_DURATION) {
                    data = parsed.data;
                    isFresh = true;
                }
            }

            if (!isFresh) {
                const response = await axios.get(`${API_BASE_URL}/api/${endpoints[category]}`);
                data = response.data;
                localStorage.setItem(cacheKey, JSON.stringify({ timestamp: Date.now(), data: data }));
            }

            populateDropdown(selectElement, data, category);
            selectElement.dataset.loaded = "true";

        } catch (error) {
            console.error(`âŒ ${category} yÃ¼klenemedi:`, error);
            defaultOption.text = "Hata: Veri AlÄ±namadÄ±";
        } finally {
            if (selectElement.options.length > 0 && selectElement.options[0].text.includes("â³")) {
                 defaultOption.text = originalText;
            }
        }
    }

    function populateDropdown(selectElement, data, category) {
        while (selectElement.options.length > 1) selectElement.remove(1);
        if (!data || data.length === 0) return;

        data.forEach(item => {
            const option = document.createElement('option');
            option.value = item.id;
            let displayName = `${item.brand || ''} ${item.modelName || ''}`.trim();
            if (category === 'storage') displayName += ` (${item.capacity} GB)`;
            if (category === 'psu') displayName += ` (${item.wattage}W)`;
            option.text = displayName;
            option.dataset.fullData = JSON.stringify(item);
            selectElement.add(option);
        });
    }

    function handleSelectionChange(event) {
        const category = event.target.id;
        const selectedId = event.target.value;
        const card = event.target.closest('.component-card');
        const errorText = document.getElementById(`error-${category}`);
        
        if(errorText) errorText.classList.add('hidden');

        if (selectedId) {
            const selectedOption = event.target.options[event.target.selectedIndex];
            if (selectedOption.dataset.fullData) {
                selectedParts[category] = JSON.parse(selectedOption.dataset.fullData);
            }
            if (card) {
                card.classList.remove('border-dashed', 'border-gray-300', 'dark:border-gray-700');
                card.classList.add('border-solid', 'border-primary', 'shadow-md', 'bg-blue-50/50', 'dark:bg-blue-900/10');
            }
        } else {
            selectedParts[category] = null;
            if (card) {
                card.classList.add('border-dashed', 'border-gray-300', 'dark:border-gray-700');
                card.classList.remove('border-solid', 'border-primary', 'shadow-md', 'bg-blue-50/50', 'dark:bg-blue-900/10');
            }
        }
        
        checkExpertButtonStatus(); // Her seÃ§imde buton durumunu gÃ¼ncelle
    }


    // ==========================================
    // CUSTOM DROPDOWN FONKSÄ°YONLARI (DÃœZELTÄ°LMÄ°Åž)
    // ==========================================

    // 1. Dropdown AÃ§/Kapa (Z-Index DÃ¼zeltmesi ile)
    function toggleCustomDropdown(category) {
        const wrapper = document.getElementById(`wrapper-${category}`);
        // MenÃ¼nÃ¼n olduÄŸu KARTI buluyoruz
        const card = wrapper.closest('.component-card'); 

        // AÃ§Ä±k olan diÄŸer menÃ¼leri kapat
        document.querySelectorAll('.custom-select-wrapper.active').forEach(el => {
            if (el !== wrapper) {
                el.classList.remove('active');
                // DiÄŸer kartlarÄ±n Z-Index'ini sÄ±fÄ±rla
                const otherCard = el.closest('.component-card');
                if (otherCard) otherCard.style.zIndex = ''; 
            }
        });

        // Toggle iÅŸlemi
        const willOpen = !wrapper.classList.contains('active');
        
        if (willOpen) {
            wrapper.classList.add('active');
            // AÃ‡ILAN KARTI EN ÃœSTE TAÅžI (Kritik Nokta)
            if (card) card.style.zIndex = '100'; 

            // Input'a odaklan
            setTimeout(() => {
                const input = wrapper.querySelector('input');
                if(input) input.focus();
            }, 100);

            // Veri yÃ¼klenmemiÅŸse yÃ¼kle
            const selectElement = document.getElementById(category);
            if (selectElement && selectElement.dataset.loaded !== "true") {
                loadComponentData(category);
            }
        } else {
            wrapper.classList.remove('active');
            // MenÃ¼ kapandÄ±ÄŸÄ±nda Z-index'i eski haline getir
            // (Animasyon bitmesi iÃ§in biraz bekle)
            if (card) setTimeout(() => card.style.zIndex = '', 200);
        }
    }

    // 2. SeÃ§enek SeÃ§me Logic'i
    function selectCustomOption(category, value, text, fullData) {
        const wrapper = document.getElementById(`wrapper-${category}`);
        const selectElement = document.getElementById(category); // Gizli Select
        const triggerText = wrapper.querySelector('.selection-text');
        const card = wrapper.closest('.component-card');

        // Gizli Select'i gÃ¼ncelle
        selectElement.value = value;
        
        // EÄŸer select iÃ§inde bu option yoksa oluÅŸtur (Manuel veri tutarlÄ±lÄ±ÄŸÄ±)
        let optionExists = Array.from(selectElement.options).some(opt => opt.value == value);
        if(!optionExists && value) {
            const newOpt = new Option(text, value);
            newOpt.dataset.fullData = JSON.stringify(fullData);
            selectElement.add(newOpt);
            selectElement.value = value;
        }

        // GÃ¶rÃ¼ntÃ¼yÃ¼ GÃ¼ncelle
        triggerText.textContent = text;
        triggerText.classList.remove('text-gray-500', 'dark:text-gray-400');
        triggerText.classList.add('text-gray-900', 'dark:text-white', 'font-medium');
        
        // "SeÃ§ili" durumunu iÅŸaretle (X butonu iÃ§in)
        wrapper.classList.add('has-selection');
        wrapper.classList.remove('active'); // MenÃ¼yÃ¼ kapat
        
        if (card) card.style.zIndex = ''; // Z-Index sÄ±fÄ±rla

        // Orijinal Logic'i Tetikle
        const event = new Event('change');
        selectElement.dispatchEvent(event);
    }

    // 3. SeÃ§imi Temizle (X Butonu) - Ã‡eviri Uyumlu
function clearCustomSelection(category, event) {
    if(event) event.stopPropagation(); // MenÃ¼ aÃ§Ä±lmasÄ±n
    
    const wrapper = document.getElementById(`wrapper-${category}`);
    const selectElement = document.getElementById(category);
    const triggerText = wrapper.querySelector('.selection-text');

    // 1. O anki dili ve sÃ¶zlÃ¼kteki karÅŸÄ±lÄ±ÄŸÄ±nÄ± al
    const currentLang = localStorage.getItem('lang') || 'tr';
    const defaultText = translations[currentLang]['select-default'];

    // 2. DeÄŸerleri SÄ±fÄ±rla
    selectElement.value = "";
    triggerText.textContent = defaultText; // ArtÄ±k dinamik olarak "Select..." veya "SeÃ§im YapÄ±nÄ±z..." yazar
    triggerText.classList.add('text-gray-500', 'dark:text-gray-400');
    triggerText.classList.remove('text-gray-900', 'dark:text-white', 'font-medium');
    
    wrapper.classList.remove('has-selection');

    // Logic'i Tetikle
    const evt = new Event('change');
    selectElement.dispatchEvent(evt);
}

    // 4. Arama Filtreleme
    function filterCustomOptions(category, searchText) {
        const filter = searchText.toLowerCase();
        const listContainer = document.getElementById(`list-${category}`);
        const items = listContainer.querySelectorAll('.custom-option');
        let hasResult = false;

        items.forEach(item => {
            const text = item.textContent.toLowerCase();
            if (text.includes(filter)) {
                item.style.display = "block";
                hasResult = true;
            } else {
                item.style.display = "none";
            }
        });

        // SonuÃ§ yok mesajÄ±
        let noMsg = listContainer.querySelector('.no-result-msg');
        if (!hasResult) {
            if(!noMsg) {
                listContainer.insertAdjacentHTML('beforeend', '<div class="no-result-msg p-3 text-center text-gray-400 text-sm">SonuÃ§ bulunamadÄ±.</div>');
            }
        } else if(noMsg) {
            noMsg.remove();
        }
    }

    // 5. DÄ±ÅŸarÄ± TÄ±klayÄ±nca Kapatma
    document.addEventListener('click', function(e) {
        if (!e.target.closest('.custom-select-wrapper')) {
            document.querySelectorAll('.custom-select-wrapper.active').forEach(el => {
                el.classList.remove('active');
                // Kart z-index dÃ¼zeltme
                const card = el.closest('.component-card');
                if (card) card.style.zIndex = '';
            });
        }
    });

    // 6. Veri Doldurma Fonksiyonunu GÃ¼ncelle (Custom Listeye UyarlÄ±)
    function populateDropdown(selectElement, data, category) {
        // Gizli Select'i Temizle (Ä°lk option hariÃ§)
        while (selectElement.options.length > 1) selectElement.remove(1);
        
        // Custom Listeyi Temizle
        const listContainer = document.getElementById(`list-${category}`);
        if(listContainer) listContainer.innerHTML = '';

        if (!data || data.length === 0) {
            if(listContainer) listContainer.innerHTML = '<div class="p-3 text-center text-gray-400 text-sm">ParÃ§a bulunamadÄ±.</div>';
            return;
        }

        data.forEach(item => {
            let displayName = `${item.brand || ''} ${item.modelName || ''}`.trim();
            if (category === 'storage') displayName += ` (${item.capacity} GB)`;
            if (category === 'psu') displayName += ` (${item.wattage}W)`;

            // A) Gizli Select'e Ekle (Logic iÃ§in)
            const option = document.createElement('option');
            option.value = item.id;
            option.text = displayName;
            option.dataset.fullData = JSON.stringify(item);
            selectElement.add(option);

            // B) Custom Listeye Ekle (GÃ¶rsel iÃ§in)
            if(listContainer) {
                const div = document.createElement('div');
                div.className = 'custom-option';
                div.textContent = displayName;
                // TÄ±klama olayÄ±nÄ± baÄŸla
                div.onclick = () => selectCustomOption(category, item.id, displayName, item);
                listContainer.appendChild(div);
            }
        });
    }

    // ==========================================
    // 5. BAÅžLATMA (INIT)
    // ==========================================

    document.addEventListener('DOMContentLoaded', function() {
        // Temel Ayarlar
        initializeTheme();
        const savedLang = localStorage.getItem('lang') || 'tr';
        setLanguage(savedLang);
        initializeData(); // Veri motorunu hazÄ±rla

        // Dil MenÃ¼sÃ¼ OlaylarÄ±
        const languageButton = document.getElementById('languageButton');
        const languageDropdown = document.getElementById('languageDropdown');
        const languageSelector = document.getElementById('languageSelector');

        if (languageButton) {
            languageButton.addEventListener('click', (e) => {
                e.stopPropagation();
                languageDropdown.classList.toggle('hidden');
            });
        }
        if (languageSelector) {
            languageSelector.addEventListener('mouseleave', () => languageDropdown.classList.add('hidden'));
        }
        document.querySelectorAll('.language-option').forEach(opt => {
            opt.addEventListener('click', (e) => {
                e.preventDefault();
                setLanguage(e.target.getAttribute('data-lang'));
                languageDropdown.classList.add('hidden');
            });
        });

        // KaranlÄ±k Mod Butonu
        const darkModeButton = document.getElementById('darkModeButton');
        if (darkModeButton) {
            darkModeButton.addEventListener('click', toggleDarkMode);
        }

        // Uzman GÃ¶rÃ¼ÅŸÃ¼ Butonu
        const expertButton = document.getElementById('expertOpinionButton');
        if (expertButton) {
            expertButton.addEventListener('click', getExpertOpinion);
        }

        // KullanÄ±cÄ± GiriÅŸ Kontrolleri
        const loginButton = document.getElementById('login-button');
        const signupButton = document.getElementById('signup-button');
        const accountSection = document.getElementById('account-section');
        const profileButton = document.getElementById('account_circle');
        const profileDropdown = document.getElementById('profileDropdown');
        const welcomeUsername = document.getElementById('welcome-username');
        const logoutButton = document.getElementById('logout-button');
        const loggedInUser = localStorage.getItem('loggedInUser');

        if (loggedInUser) {
            if(loginButton) loginButton.style.display = 'none';
            if(signupButton) signupButton.style.display = 'none';
            if(accountSection) {
                accountSection.classList.remove('hidden');
                accountSection.classList.add('flex');
            }
            if(welcomeUsername) welcomeUsername.textContent = loggedInUser;
        }

        if (profileButton) {
            profileButton.addEventListener('click', (e) => {
                e.stopPropagation();
                if(profileDropdown) profileDropdown.classList.toggle('hidden');
            });
        }

        // DÄ±ÅŸarÄ± tÄ±klayÄ±nca dropdownlarÄ± kapat
        document.addEventListener('click', (e) => {
            if (profileDropdown && !profileDropdown.classList.contains('hidden') && !accountSection.contains(e.target)) {
                profileDropdown.classList.add('hidden');
            }
            if (languageDropdown && !languageDropdown.classList.contains('hidden') && !languageSelector.contains(e.target)) {
                languageDropdown.classList.add('hidden');
            }
        });

        if (logoutButton) {
            logoutButton.addEventListener('click', (e) => {
                e.preventDefault();
                Swal.fire({
                    title: 'Ã‡Ä±kÄ±ÅŸ YapÄ±lÄ±yor...',
                    icon: 'success',
                    showConfirmButton: false,
                    timer: 1000,
                    background: '#1f2937', color: '#fff'
                }).then(() => {
                    localStorage.removeItem('loggedInUser');
                    window.location.reload();
                });
            });
        }
    
        // --- 6. UYUMLULUK KONTROL TETÄ°KLEYÄ°CÄ°SÄ° (YENÄ° EKLENEN KISIM) ---
        const checkBtn = document.getElementById('checkCompatibilityBtn');
        if (checkBtn) {
            checkBtn.addEventListener('click', (e) => {
                e.preventDefault(); // SayfanÄ±n yukarÄ± zÄ±plamasÄ±nÄ± engeller
                checkCompatibility(); // Birazdan yazacaÄŸÄ±mÄ±z ana fonksiyonu Ã§aÄŸÄ±rÄ±r
            });
        }

    // ==========================================
    // 7. UYUMLULUK MOTORU (LOGIC)
    // ==========================================

    // =============================
// YENÄ° NESÄ°L UYUMLULUK MOTORU (MODEL UYUMLU FINAL)
// =============================

function checkCompatibility() {

    console.log("ðŸ› ï¸ GeliÅŸmiÅŸ uyumluluk kontrolÃ¼ baÅŸlatÄ±ldÄ±...");

    // =====================
    // UI TEMÄ°ZLEME
    // =====================
    document.getElementById('result-info').classList.add('hidden');
    document.getElementById('result-success').classList.add('hidden');
    document.getElementById('result-fail').classList.add('hidden');
    document.getElementById('fail-reasons').innerHTML = '';
    document.querySelectorAll('[id^="error-"]').forEach(el => el.classList.add('hidden'));

    // =====================
    // KONTROL YARDIMCI FONKSÄ°YONLARI
    // =====================
    const isFilled = obj => obj && typeof obj === 'object' && Object.keys(obj).length > 0;

    const toNumber = (v, fallback = 0) => {
        if (typeof v === "number") return v;
        if (!v) return fallback;
        const n = Number(String(v).replace(/[^\d.-]/g, ""));
        return isNaN(n) ? fallback : n;
    };

    const toInt = (v, fallback = 0) => Math.round(toNumber(v, fallback));
    
    const toBoolean = v => {
        if (typeof v === 'boolean') return v;
        if (typeof v === 'string') return ['true', '1', 'yes'].includes(v.toLowerCase());
        return false;
    };

    const normalizeString = v => v ? String(v).trim() : "";
    
    // String (virgÃ¼llÃ¼) veya Array gelebilecek verileri dÃ¼zeltir
    const normalizeStringArray = v => {
        if (!v) return [];
        if (Array.isArray(v)) return v.map(x => String(x).trim().toLowerCase());
        return String(v).split(',').map(x => x.trim().toLowerCase()).filter(x => x.length > 0);
    };

    // SayÄ± dizisi veya virgÃ¼llÃ¼ string gelebilecek verileri dÃ¼zeltir
    const normalizeNumberArray = v => {
        if (!v) return [];
        if (Array.isArray(v)) return v.map(x => toInt(x)).filter(n => !isNaN(n));
        if (typeof v === 'string') return v.split(',').map(s => toInt(s)).filter(n => !isNaN(n));
        return [];
    };

    const addIssue = (level, msg, cards = []) => {
        issues.push({ level, msg });
        cards.forEach(c => showErrorUnderCard(c, level === "critical" ? "Hata" : "UyarÄ±"));
    };

    const escapeHtml = str => String(str).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");

    // =====================
    // HATA / UYARI LÄ°STESÄ°
    // =====================
    const issues = [];

    // =====================
    // PARÃ‡A AL (Veri Modelleriyle EÅŸleÅŸme)
    // =====================
    const cpu = selectedParts.cpu;
    const mobo = selectedParts.motherboard;
    const ram = selectedParts.ram;
    const gpu = selectedParts.gpu;
    const psu = selectedParts.psu;
    const pcCase = selectedParts.case; // 'case' keyword olduÄŸu iÃ§in pcCase dedik
    const cooler = selectedParts.cpuCooler;
    // Storage tekil veya Ã§oÄŸul gelebilir, diziye Ã§eviriyoruz
    const storages = Array.isArray(selectedParts.storage) ? selectedParts.storage : (selectedParts.storage ? [selectedParts.storage] : []);

    // =====================
    // 1) PARÃ‡A SAYISI KONTROLÃœ
    // =====================
    const filledParts = Object.values(selectedParts).filter(p => p !== null && !Array.isArray(p)) 
                        .concat(storages.length > 0 ? ['storage'] : []).length;

    // Not: filledParts mantÄ±ÄŸÄ±nÄ± basitleÅŸtirdik, en az 2 dolu obje var mÄ± bakar.
    const activeComponents = Object.values(selectedParts).filter(x => x !== null);
    
    if (activeComponents.length < 2) {
        Swal.fire({
            title: 'Yetersiz ParÃ§a',
            text: 'LÃ¼tfen analiz iÃ§in en az 2 parÃ§a seÃ§in.',
            icon: 'warning',
            background: '#1f2937', color: '#fff', confirmButtonColor: '#16a3b2'
        });
        document.getElementById('result-info').classList.remove('hidden');
        return;
    }

    // =============================
    // 2) CPU â†” MOTHERBOARD
    // =============================
    if (isFilled(cpu) && isFilled(mobo)) {
        // Model: cpu.socket, mobo.socket
        const cpuSocket = normalizeString(cpu.socket).toLowerCase();
        const moboSocket = normalizeString(mobo.socket).toLowerCase();

        if (cpuSocket && moboSocket && cpuSocket !== moboSocket) {
            addIssue("critical", `CPU soketi (${cpu.socket}) ile Anakart soketi (${mobo.socket}) uyumsuz.`, ["cpu", "motherboard"]);
        }

        // Model: cpu.integratedGraphics (bool)
        const hasIgpu = toBoolean(cpu.integratedGraphics);
        const gpuExists = isFilled(gpu);

        // EÄŸer harici GPU yoksa ve iÅŸlemcide grafik birimi yoksa gÃ¶rÃ¼ntÃ¼ gelmez
        if (!gpuExists && !hasIgpu) {
            addIssue("critical", `SeÃ§ilen iÅŸlemcide (${cpu.modelName}) dahili grafik birimi yok. GÃ¶rÃ¼ntÃ¼ alabilmek iÃ§in ekran kartÄ± eklemelisiniz.`, ["cpu", "gpu"]);
        }
    }

    // =============================
    // 3) RAM â†” MOTHERBOARD
    // =============================
    if (isFilled(ram) && isFilled(mobo)) {
        // Model: ram.memoryType (DDR4), mobo.memoryType (DDR4)
        const ramType = normalizeString(ram.memoryType).toLowerCase();
        const moboMemType = normalizeString(mobo.memoryType).toLowerCase();

        if (ramType && moboMemType && ramType !== moboMemType) {
            addIssue("critical", `RAM tipi (${ram.memoryType}) ile Anakart (${mobo.memoryType}) uyumsuz.`, ["ram", "motherboard"]);
        }

        // Model: ram.moduleCount, mobo.memorySlots
        const ramModules = toInt(ram.moduleCount || 1);
        const moboSlots = toInt(mobo.memorySlots || 0);

        if (moboSlots > 0 && ramModules > moboSlots) {
            addIssue("critical", `SeÃ§ilen RAM kiti (${ramModules} modÃ¼l), anakartÄ±n slot sayÄ±sÄ±nÄ± (${moboSlots}) aÅŸÄ±yor.`, ["ram", "motherboard"]);
        }

        // Model: ram.capacityPerModule, mobo.maxMemory
        const capPerModule = toInt(ram.capacityPerModule || 0);
        const totalRam = capPerModule * ramModules;
        const maxMoboRam = toInt(mobo.maxMemory || 0);

        if (maxMoboRam > 0 && totalRam > maxMoboRam) {
            addIssue("critical", `Toplam RAM (${totalRam}GB), anakartÄ±n maksimum desteÄŸini (${maxMoboRam}GB) aÅŸÄ±yor.`, ["ram", "motherboard"]);
        }

        // Model: ram.speed, mobo.supportedMemoryFrequencies (List<int>)
        const ramSpeed = toInt(ram.speed || 0);
        // Backend'den dizi veya string gelebilir, helper ile dÃ¼zelt
        const supportedSpeeds = normalizeNumberArray(mobo.supportedMemoryFrequencies);

        if (ramSpeed > 0 && supportedSpeeds.length > 0) {
            const maxSpeed = Math.max(...supportedSpeeds);
            if (ramSpeed > maxSpeed) {
                addIssue("warning", `RAM hÄ±zÄ± (${ramSpeed}MHz), anakartÄ±n desteklediÄŸi maksimum hÄ±zdan (${maxSpeed}MHz) yÃ¼ksek. RAM Ã§alÄ±ÅŸÄ±r ancak hÄ±zÄ± dÃ¼ÅŸer (Downclock).`, ["ram", "motherboard"]);
            }
        }
    }

    // =============================
    // 4) GPU â†” KASA / PSU
    // =============================
    if (isFilled(gpu)) {
        // ---- Kasa GPU UzunluÄŸu ----
        if (isFilled(pcCase)) {
            // Model: gpu.length, pcCase.maxGpuLength
            const gpuLen = toInt(gpu.length); 
            const maxGpu = toInt(pcCase.maxGpuLength);

            if (gpuLen > 0 && maxGpu > 0 && gpuLen > maxGpu) {
                addIssue("critical", `Ekran kartÄ± uzunluÄŸu (${gpuLen}mm), kasanÄ±n sÄ±nÄ±rÄ±nÄ± (${maxGpu}mm) aÅŸÄ±yor. SÄ±ÄŸmayacaktÄ±r.`, ["gpu", "case"]);
            }
        }

        // ---- PSU YeterliliÄŸi ----
        if (isFilled(psu)) {
            // Model: gpu.tdp, cpu.tdp, psu.wattage
            const gpuPower = toInt(gpu.tdp || 0);
            const cpuPower = toInt(cpu?.tdp || 0);
            const systemBase = 100; // Anakart, fanlar vs. iÃ§in pay
            const totalLoad = gpuPower + cpuPower + systemBase;
            const psuWatt = toInt(psu.wattage);

            // Kritik GÃ¼Ã§ YetmezliÄŸi
            if (psuWatt < totalLoad) {
                addIssue("critical", `PSU gÃ¼cÃ¼ (${psuWatt}W) yetersiz. Sistem yÃ¼k altÄ±nda tahmini ${totalLoad}W Ã§ekecek.`, ["psu"]);
            } 
            // GÃ¼venlik PayÄ± (%20)
            else if (psuWatt < Math.ceil(totalLoad * 1.20)) {
                addIssue("warning", `PSU kapasitesi sÄ±nÄ±rda. Ã–nerilen gÃ¼venli deÄŸer: ${Math.ceil(totalLoad * 1.20)}W ve Ã¼zeri.`, ["psu"]);
            }

            // Model: gpu.recommendedPsu (Ãœretici Tavsiyesi)
            const recPsu = toInt(gpu.recommendedPsu);
            if (recPsu > 0 && psuWatt < recPsu) {
                addIssue("warning", `PSU gÃ¼cÃ¼ yeterli gÃ¶rÃ¼nse de, ekran kartÄ± Ã¼reticisi bu model iÃ§in en az ${recPsu}W Ã¶nermektedir (AnlÄ±k gÃ¼Ã§ sÄ±Ã§ramalarÄ± iÃ§in).`, ["psu"]);
            }

            // ---- 12VHPWR Kablo KontrolÃ¼ (RTX 4000 Serisi) ----
            // Model: gpu.powerConnectors (string), psu.has12VHPWR (bool)
            const gpuConStr = normalizeString(gpu.powerConnectors).toLowerCase();
            const psuHasNewPort = toBoolean(psu.has12VHPWR);

            if ((gpuConStr.includes('16pin') || gpuConStr.includes('12vhpwr')) && !psuHasNewPort) {
                addIssue("warning", `Ekran kartÄ± yeni nesil 12VHPWR gÃ¼Ã§ giriÅŸi istiyor, PSU'nuzda bu port yok. DÃ¶nÃ¼ÅŸtÃ¼rÃ¼cÃ¼ kullanmanÄ±z gerekecek.`, ["gpu", "psu"]);
            }
        }
    }

    // =============================
    // 5) CPU COOLER â†” KASA
    // =============================
    if (isFilled(cooler) && isFilled(pcCase)) {
        // Model: cooler.coolerType ("Air"/"Liquid")
        const type = normalizeString(cooler.coolerType).toLowerCase();

        // Hava SoÄŸutma
        if (type === "air") {
            // Model: cooler.height, pcCase.maxCpuCoolerHeight
            const h = toInt(cooler.height);
            const maxH = toInt(pcCase.maxCpuCoolerHeight);

            if (h > maxH && maxH > 0) {
                addIssue("critical", `SoÄŸutucu yÃ¼ksekliÄŸi (${h}mm), kasanÄ±n kapaÄŸÄ±na Ã§arpÄ±yor (Maks: ${maxH}mm).`, ["cpuCooler", "case"]);
            }
        } 
        // SÄ±vÄ± SoÄŸutma
        else if (type === "liquid") {
            // Model: cooler.radiatorSize (int: 240), pcCase.radiatorSupportFront (string: "120, 240")
            const radSize = toInt(cooler.radiatorSize);
            
            // Kasa verilerini parÃ§ala ve sayÄ±ya Ã§evir
            const frontSup = normalizeNumberArray(pcCase.radiatorSupportFront);
            const topSup = normalizeNumberArray(pcCase.radiatorSupportTop);

            const fitsFront = frontSup.includes(radSize);
            const fitsTop = topSup.includes(radSize);

            if (!fitsFront && !fitsTop) {
                addIssue("critical", `SeÃ§ilen ${radSize}mm radyatÃ¶r, kasanÄ±n ne Ã¶n ne de Ã¼st paneline uyuyor.`, ["cpuCooler", "case"]);
            }
        }
    }

    // =============================
    // 6) PSU â†” KASA (Boyut)
    // =============================
    if (isFilled(psu) && isFilled(pcCase)) {
        // Model: psu.length, pcCase.maxPsuLength
        const psuLen = toInt(psu.length);
        const maxPsuLen = toInt(pcCase.maxPsuLength);

        if (psuLen > 0 && maxPsuLen > 0 && psuLen > maxPsuLen) {
            addIssue("critical", `PSU uzunluÄŸu (${psuLen}mm), kasanÄ±n PSU bÃ¶lmesine sÄ±ÄŸmÄ±yor (Maks: ${maxPsuLen}mm).`, ["psu", "case"]);
        }
    }

    // =============================
    // 7) KASA â†” ANAKART (Form FaktÃ¶r)
    // =============================
    if (isFilled(pcCase) && isFilled(mobo)) {
        // Model: pcCase.supportedMotherboards (String: "ATX, Micro-ATX"), mobo.formFactor (String: "ATX")
        const supported = normalizeString(pcCase.supportedMotherboards).toLowerCase();
        const moboForm = normalizeString(mobo.formFactor).toLowerCase();

        if (supported && moboForm && !supported.includes(moboForm)) {
             addIssue("critical", `Kasa, ${mobo.formFactor} boyutundaki anakartÄ± desteklemiyor.`, ["case", "motherboard"]);
        }
    }

    // =============================
    // 8) STORAGE (M.2 SayÄ±sÄ±)
    // =============================
    if (storages.length > 0 && isFilled(mobo)) {
        // Model: storage.formFactor ("M.2", "2.5 Inch")
        // Model: mobo.m2SlotCount, mobo.sataPortCount
        
        let m2Count = 0;
        let sataCount = 0;

        storages.forEach(s => {
            const ff = normalizeString(s.formFactor).toLowerCase();
            if (ff.includes('m.2')) m2Count++;
            else if (ff.includes('2.5') || ff.includes('3.5')) sataCount++;
        });

        const moboM2Slots = toInt(mobo.m2SlotCount);
        const moboSataPorts = toInt(mobo.sataPortCount);

        if (m2Count > moboM2Slots) {
             addIssue("critical", `Anakartta ${moboM2Slots} adet M.2 yuvasÄ± var, ancak siz ${m2Count} adet M.2 disk seÃ§tiniz.`, ["storage", "motherboard"]);
        }
        if (sataCount > moboSataPorts) {
             addIssue("critical", `Anakartta ${moboSataPorts} adet SATA portu var, ancak siz ${sataCount} adet SATA disk seÃ§tiniz.`, ["storage", "motherboard"]);
        }
    }

    // =============================
    // SONUÃ‡LARI GÃ–STER (GÃœNCELLENMÄ°Åž TASARIM Ä°Ã‡Ä°N)
    // =============================
    const failDiv = document.getElementById('result-fail');
    const reasonList = document.getElementById('fail-reasons');
    const successDiv = document.getElementById('result-success');
    const successText = document.getElementById('success-text');
    const infoDiv = document.getElementById('result-info');

    if (issues.length > 0) {
        // HatalarÄ± ÅžIK KUTULAR olarak listele
        const critical = issues.filter(i => i.level === "critical");
        const warning = issues.filter(i => i.level === "warning");

        const html =
            critical.map(i => `
                <li class="flex items-start gap-3 bg-white dark:bg-red-950/30 p-4 rounded-lg border-l-4 border-l-red-500 border border-gray-100 dark:border-red-900/50 shadow-sm">
                    <span class="material-symbols-outlined text-red-500 shrink-0 mt-0.5">error</span>
                    <span class="text-gray-800 dark:text-red-100 text-sm font-medium leading-normal">${escapeHtml(i.msg)}</span>
                </li>
            `).join('') +
            warning.map(i => `
                <li class="flex items-start gap-3 bg-white dark:bg-orange-950/30 p-4 rounded-lg border-l-4 border-l-orange-500 border border-gray-100 dark:border-orange-900/50 shadow-sm">
                    <span class="material-symbols-outlined text-orange-500 shrink-0 mt-0.5">warning</span>
                    <span class="text-gray-800 dark:text-orange-100 text-sm font-medium leading-normal">${escapeHtml(i.msg)}</span>
                </li>
            `).join('');

        reasonList.innerHTML = html;
        
        infoDiv.classList.add('hidden');
        successDiv.classList.add('hidden');
        successDiv.classList.remove('flex'); // Flex'i kapat
        
        failDiv.classList.remove('hidden');
        failDiv.classList.add('flex'); // Flex'i aÃ§
        
        failDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });

    } else {
        // BaÅŸarÄ±lÄ± Durumu
        successText.innerHTML = `SeÃ§ilen parÃ§alar (<b>${filledParts} adet</b>) birbiriyle tam uyumlu gÃ¶rÃ¼nÃ¼yor.<br>Herhangi bir teknik Ã§akÄ±ÅŸma tespit edilmedi. Ä°yi oyunlar! ðŸŽ®`;
        
        infoDiv.classList.add('hidden');
        failDiv.classList.add('hidden');
        failDiv.classList.remove('flex'); // Flex'i kapat

        successDiv.classList.remove('hidden');
        successDiv.classList.add('flex'); // Flex'i aÃ§
        
        successDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
}

// =============================
// HATA GÃ–STERME YARDIMCISI
// =============================
function showErrorUnderCard(category, message) {
    const el = document.getElementById(`error-${category}`);
    if (!el) return;

    const text = el.querySelector(".error-text");
    if (text) text.textContent = message;

    el.classList.remove("hidden");
}
    
    });

</script>
</body>
</html>