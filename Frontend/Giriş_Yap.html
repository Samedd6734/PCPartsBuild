<!DOCTYPE html>
<html class="dark" lang="tr"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title data-i18n="auth-signup-title">Kayıt Ol - PCPartsBuild</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
<script>
    tailwind.config = {
      // Karanlık mod sabitlendi
      theme: {
        extend: {
          colors: {
            primary: "#16a3b2",
            "background-light": "#f0f2f5", // Kullanılmayacak
            "background-dark": "#0d1117",
          },
          fontFamily: {
            display: ["Poppins", "sans-serif"],
          },
          borderRadius: {
            DEFAULT: "0.5rem",
          },
        },
      },
    };
  </script>
    <style>
    .material-symbols-outlined {
      font-variation-settings: 'FILL' 0,
      'wght' 400,
      'GRAD' 0,
      'opsz' 24
    }
    .transition-default {
        transition: color 0.3s, background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
    }
    body {
      min-height: max(884px, 100dvh);
    }
    #bg-video {
      position: fixed;
      right: 0;
      bottom: 0;
      min-width: 100%;
      min-height: 100%;
      width: auto;
      height: auto;
      z-index: -100;
      object-fit: cover;
      opacity: 0.1;
    }
  </style>
  </head>
<!-- Body karanlık moda sabitlendi -->
<body class="bg-background-dark font-display text-gray-300 transition-default overflow-hidden">
<video autoplay="" id="bg-video" loop="" muted="" playsinline="">
<source src="Assets/Videos/Video1.webm" type="video/webm"/>
    Your browser does not support the video tag.
  </video>
<a class="absolute top-4 left-4 z-20 w-12 h-12 rounded-full bg-black/30 backdrop-blur-md border border-white/20 flex items-center justify-center text-white hover:bg-black/50 transition-colors" href="anasayfa.html">
<span class="material-symbols-outlined text-xl">
      home
    </span>
</a>

<!-- DİL BUTONLARI -->
<div class="absolute top-4 right-4 z-20 flex items-center gap-2">
    <!-- DİL SEÇİMİ BUTONU VE DROPDOWN KAPSAYICISI -->
    <div id="languageSelector" class="relative">
        <button id="languageButton" class="flex cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 w-10 bg-white/10 text-white transition-colors hover:bg-white/20">
            <span class="material-symbols-outlined text-xl">language</span>
        </button>
        <div id="languageDropdown" class="absolute right-0 top-full pt-1 w-32 bg-gray-800/80 backdrop-blur-md border border-gray-700 rounded-lg shadow-xl overflow-hidden z-30 hidden">
            <a href="#" data-lang="tr" class="language-option block px-4 py-2 text-sm text-gray-200 font-medium hover:bg-primary/80 hover:text-white transition-colors duration-150">Türkçe (TR)</a>
            <a href="#" data-lang="en" class="language-option block px-4 py-2 text-sm text-gray-200 font-medium hover:bg-primary/80 hover:text-white transition-colors duration-150">English (EN)</a>
        </div>
    </div>
</div>
<!-- DİL BUTONLARI BİTTİ -->


<div class="relative min-h-screen grid grid-cols-1 lg:grid-cols-2">
<div class="hidden lg:flex flex-col items-center justify-center text-center px-8">
<img src="Assets/Images/logo.webp" alt="PCPartsBuild Logo" class="h-40">
<h2 class="font-bold text-5xl text-white mt-4"></h2>
<p class="text-gray-400 mt-2 max-w-sm" data-i18n="auth-welcome-subtitle">Hayalinizdeki Bilgisayarı hassasiyet ve güvenle tasarlayın.</p>
</div>
<div class="relative flex items-center justify-center p-4 lg:p-8">
<div class="absolute inset-0 bg-black/30 backdrop-blur-sm"></div>
<div class="relative w-full max-w-md p-6 sm:p-8 bg-gray-900/90 rounded-lg shadow-2xl">
<header class="text-center lg:text-left mb-6">
<h1 class="text-2xl font-bold text-white" data-i18n="auth-login-title">Hoşgeldiniz</h1>
<p class="text-gray-400 mt-1" data-i18n="auth-login-subtitle">Özel bilgisayar yolculuğunuza bugün başlayın..</p>
</header>
<main>
<form class="space-y-4">
<div>
<label class="block text-sm font-medium text-gray-300 mb-1" for="email" data-i18n="label-email-user">Kulanıcı</label>
<input class="w-full bg-gray-800 border-gray-700 rounded-md focus:ring-primary focus:border-primary text-white placeholder:text-gray-500 transition-default" id="email , username " name="email , username" data-i18n-placeholder="placeholder-email-user" placeholder="Email \ Kullanıcı_Adı" type="text"/>
</div>
<div>
<label class="block text-sm font-medium text-gray-300 mb-1" for="password" data-i18n="label-password">Şifre</label>
<input class="w-full bg-gray-800 border-gray-700 rounded-md focus:ring-primary focus:border-primary text-white placeholder:text-gray-500 transition-default" id="password" name="password" placeholder="••••••••" type="password"/>
</div>
<button class="w-full bg-primary text-white font-semibold py-3 px-6 rounded-lg shadow-lg shadow-primary/30 flex items-center justify-center gap-2 mt-2 hover:bg-primary/90 transition-colors" type="submit" data-i18n="action-login">
            Giriş Yap
          </button>
</form>
<div class="text-right mt-4">
    <a href="sifremi-unuttum.html" class="text-sm text-primary hover:underline">
        Şifreni mi unuttun?
    </a>
</div>
</main>
<footer class="text-center mt-6">
<p class="text-sm text-gray-400" data-i18n="link-no-account-container">
          <span data-i18n="link-no-account">Henüz Kayıt olmadın mı?</span>
          <a class="font-medium text-primary hover:underline" href="kaydol.html" data-i18n="link-signup">Kayıt Ol</a>
</p>
</footer>
</div>
<footer class="absolute bottom-8"> <p class="text-xs text-gray-500"> © 2025 PCPartsBuild. Tüm Hakları Saklıdır. Bize Ulaşın: 
        <a class="text-primary hover:underline" href="mailto:pcpartsbuild@gmail.com">pcpartsbuild@gmail.com</a>
    </p>
</footer>
</div>
</div>

<script>
    // Çeviri Sözlüğü (Senin kodun - Dokunulmadı)
    const translations = {
        tr: {
            "app-builder": "PCPartsBuild",
            "auth-signup-title": "Giriş Yap - PCPartsBuild", // Başlık "Giriş Yap" olarak güncellendi (Dosyadan alındı)
            "auth-welcome-title": "Hoşgeldiniz",
            "auth-login-title": "Giriş Yap",
            "auth-login-subtitle": "Lütfen hesabınıza giriş yapın.",
            "auth-welcome-subtitle": "Hayalinizdeki Bilgisayarı hassasiyet ve güvenle tasarlayın.",
            "label-email-user": "Kulanıcı",
            "placeholder-email-user": "Email \\ Kullanıcı Adı",
            "label-password": "Şifre",
            "action-login": "Giriş Yap",
            "link-no-account": "Henüz Kayıt olmadın mı?",
            "link-signup": "Kayıt Ol",
        },
        en: {
            "app-builder": "PCPartsBuild",
            "auth-signup-title": "Log In - PCPartsBuild", // Başlık "Log In" olarak güncellendi (Dosyadan alındı)
            "auth-welcome-title": "Welcome Back",
            "auth-login-title": "Log In",
            "auth-login-subtitle": "Please log into your account.",
            "auth-welcome-subtitle": "Design your dream PC with precision and confidence.",
            "label-email-user": "User",
            "placeholder-email-user": "Email \\ Username",
            "label-password": "Password",
            "action-login": "Log In",
            "link-no-account": "Don't have an account yet?",
            "link-signup": "Sign Up",
        }
    };

    // Sayfadaki tüm çevrilebilir elementleri güncelleyen ana fonksiyon (Senin kodun - Dokunulmadı)
    const setLanguage = (lang) => {
        // ... (Senin dil kodun burada, olduğu gibi kalıyor) ...
        localStorage.setItem('lang', lang);
        document.documentElement.lang = lang;
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            const translation = translations[lang][key];
            if (translation) {
                // Özel Durum: link-no-account-container (içinde link olduğu için)
                if (key === 'link-no-account') {
                    const container = document.querySelector('[data-i18n="link-no-account-container"]');
                    const link = document.querySelector('[data-i18n="link-signup"]');
                    if (container && link) {
                        container.innerHTML = `${translation} <a class="font-medium text-primary hover:underline" href="kaydol.html" data-i18n="link-signup">${translations[lang]['link-signup']}</a>`;
                    }
                } else {
                    element.textContent = translation;
                }
            }
        });
        document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
            const key = element.getAttribute('data-i18n-placeholder');
            const translation = translations[lang][key];
            if (translation) {
                element.placeholder = translation;
            }
        });
        // Title etiketini de bu sayfanın başlığıyla güncelliyoruz
        document.title = translations[lang]["auth-signup-title"]; 
    };
    
    // Başlatma fonksiyonu (Senin kodun - Dokunulmadı)
    const initializeLang = () => {
        const savedLang = localStorage.getItem('lang');
        let currentLang = savedLang || document.documentElement.lang || 'tr'; 
        setLanguage(currentLang);
    };
    
    // Tema başlatma (Senin kodun - Dokunulmadı)
    const initializeTheme = () => {
        document.documentElement.classList.add('dark');
        localStorage.setItem('theme', 'dark'); 
    };

    // --- TÜM İŞLEMLERİN BAŞLADIĞI YER ---
    document.addEventListener('DOMContentLoaded', function() {
        // Dili ve Temayı başlat (Senin kodun - Dokunulmadı)
        initializeLang();
        initializeTheme();
        
        // Dil Menüsü Kodları (Senin kodun - Dokunulmadı)
        const languageSelector = document.getElementById('languageSelector');
        const languageButton = document.getElementById('languageButton');
        const languageDropdown = document.getElementById('languageDropdown');
        const languageOptions = languageDropdown ? languageDropdown.querySelectorAll('.language-option') : null;
        
        if (languageSelector && languageButton && languageDropdown && languageOptions) {
            // ... (Senin dil menüsü kodların burada, olduğu gibi kalıyor) ...
            const hideDropdown = () => { languageDropdown.classList.add('hidden'); };
            const showDropdown = () => { languageDropdown.classList.remove('hidden'); };
            languageButton.addEventListener('click', function(event) {
                event.stopPropagation();
                if (languageDropdown.classList.contains('hidden')) { showDropdown(); } else { hideDropdown(); }
            });
            languageSelector.addEventListener('mouseleave', hideDropdown);
            document.addEventListener('click', function(event) {
                if (!languageSelector.contains(event.target)) { hideDropdown(); }
            });
            languageOptions.forEach(option => {
                option.addEventListener('click', function(e) {
                    e.preventDefault();
                    const selectedLang = this.getAttribute('data-lang');
                    setLanguage(selectedLang);
                    hideDropdown();
                });
            });
        }
        
        // --- BURADAN İTİBAREN YENİ EKLENEN API GİRİŞ KODU ---
        
        // 1. Giriş formunu bul
        const loginForm = document.querySelector('form'); // Sayfadaki tek form olduğunu varsayıyoruz

        if (loginForm) {
            // 2. Formun "gönder" (submit) eylemini dinle
            loginForm.addEventListener('submit', async function(e) {
                e.preventDefault(); // Formun, sayfayı yeniden yüklemesini engelle

                // 3. Formdaki inputların değerlerini al
                // DİKKAT: HTML'deki ID'n 'email , username ' şeklinde (boşluklu). 
                // Bu ID'yi 'login-identifier' gibi temiz bir ID ile değiştirmen en doğrusu olur.
                // Ama şimdilik mevcut ID'ne göre kodluyorum.
                const loginIdentifier = document.getElementById('email , username ').value;
                const password = document.getElementById('password').value;

                // 4. Backend'deki LoginDto ile eşleşen bir JSON nesnesi oluştur
                const loginData = {
                    loginIdentifier: loginIdentifier,
                    password: password
                };

                // 5. API'ye (Backend'e) fetch ile POST isteği gönder
                try {
                    // !!! DİKKAT: 'https://localhost:7231' adresini kendi C# projenin
                    // çalıştığı adres ile (o siyah CMD ekranında yazan) değiştirmen gerekebilir.
                    const response = await fetch('https://pcpartsbuild.com/api/auth/login', { 
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(loginData) // JSON'a çevirip gönder
                    });

                    // 6. Cevabı kontrol et
                    if (response.ok) {
                        // BAŞARILI GİRİŞ
                        const result = await response.json(); 
                        
                        // --- YENİ EKLENEN KOD ---
                        // Kullanıcıyı tarayıcının hafızasına kaydediyoruz.
                        // Ana sayfa bu bilgiyi okuyacak.
                        localStorage.setItem('loggedInUser', result.username); 
                        // --- YENİ KODUN SONU ---
                        alert('Giriş başarılı! Hoş geldin, ' + result.username);
                        
                        // Giriş başarılı olduğu için kullanıcıyı anasayfaya yönlendir
                        window.location.href = 'anasayfa.html'; 
                    } else {
                        // Backend hata verdiyse (örn: şifre yanlış)
                        alert('Giriş başarısız: Kullanıcı adı veya şifre hatalı.');
                    }
                } catch (error) {
                    // Sunucuya hiç ulaşılamazsa (Backend çalışmıyor veya CORS hatası varsa)
                    console.error('Sunucu hatası:', error);
                    alert('Sunucuya bağlanırken bir hata oluştu. Backend projenizin çalıştığından emin olun.');
                }
            });
        }
        // --- YENİ EKLENEN KODUN SONU ---
    });
</script>
</body>
</html>
